# Архитектура CrossPoster

## Обзор

CrossPoster - это приложение для автоматического кросспостинга между различными социальными сетями. Приложение написано на Python с использованием фреймворка FastAPI и обеспечивает асинхронную обработку задач через Celery.

## Стек технологий

- **Python 3.10** - основной язык программирования
- **FastAPI** - веб-фреймворк для создания API
- **SQLAlchemy** - ORM для работы с базой данных
- **PostgreSQL** - основная база данных
- **Redis** - брокер сообщений для Celery
- **Celery** - асинхронная очередь задач
- **APScheduler** - планировщик задач
- **Docker & Docker Compose** - контейнеризация

## Структура проекта

```
CrossPoster/
├── app/
│   ├── api/              # API эндпоинты
│   ├── models/           # Модели базы данных
│   ├── schemas/          # Схемы Pydantic
│   ├── social/           # Клиенты социальных сетей
│   ├── tasks/            # Асинхронные задачи
│   ├── core/             # Конфигурация приложения
│   └── main.py           # Основное приложение
├── alembic/              # Миграции базы данных
├── requirements.txt      # Зависимости Python
├── Dockerfile            # Docker образ приложения
├── docker-compose.yml    # Оркестрация Docker контейнеров
└── README.md             # Документация
```

## Компоненты

### 1. Web API (FastAPI)

Основной веб-сервер, предоставляющий REST API для:
- Управления пользователями
- Управления аккаунтами социальных сетей
- Управления постами
- Просмотра статистики

### 2. Celery Worker

Обрабатывает асинхронные задачи:
- Публикация постов в социальных сетях
- Мониторинг новых постов
- Обработка медиа-файлов

### 3. Scheduler

Отвечает за периодические задачи:
- Проверка новых постов в социальных сетях
- Отправка уведомлений
- Сбор статистики

### 4. Клиенты социальных сетей

Реализованы клиенты для работы с различными платформами:
- **VKClient** - клиент для ВКонтакте
- **TelegramClient** - клиент для Telegram
- **InstagramClient** - клиент для Instagram
- **PinterestClient** - клиент для Pinterest
- **YouTubeClient** - клиент для YouTube

### 5. Модель данных

#### User
- Хранит информацию о пользователях приложения

#### SocialAccount
- Хранит информацию об аккаунтах социальных сетей
- Связан с пользователем
- Хранит токены доступа

#### Post
- Хранит информацию о постах
- Может быть связан с оригинальным постом
- Хранит медиа-файлы

#### Statistics
- Хранит статистику по публикациям
- Отслеживает охват и взаимодействия

## Безопасность

- Все чувствительные данные хранятся в переменных окружения
- Используется JWT-аутентификация
- Все API-ключи хранятся в зашифрованном виде
- Валидация входных данных через Pydantic-схемы

## Масштабируемость

- Архитектура позволяет легко добавлять новые социальные сети
- Использование очередей задач позволяет масштабировать обработку
- Контейнеризация позволяет легко разворачивать на разных платформах

## Обработка ошибок

- Каждый клиент социальной сети имеет собственную обработку ошибок
- Повторная отправка в случае сбоев
- Логирование всех операций
- Уведомления о критических ошибках

## Мониторинг

- Статистика публикаций
- Мониторинг производительности
- Логирование всех действий
- Возможность отслеживания прогресса репостов